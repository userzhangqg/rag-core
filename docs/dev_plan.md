# rag-core

# RAG知识库系统开发计划

## 项目概述
开发一个核心RAG知识库系统，支持文档上传、解析、分片、向量化、用户检索、召回、重排、Prompt处理和LLM生成等功能。系统提供API和命令行两种交互方式。

## 技术栈
- Python 3.11
- FastAPI
- SQLAlchemy
- PostgreSQL
- Docker
- Langchain
- LlamaIndex
- minIO
- Weaviate
- Redis

## 项目阶段

### 第一阶段：需求分析与架构设计
- 确定系统功能需求
- 设计系统架构
- 确定技术选型细节
- 制定API规范

### 第二阶段：基础环境搭建
- 项目脚手架搭建
- 数据库设计与初始化
- Docker环境配置
- 基础依赖安装

### 第三阶段：核心功能开发
- 文档上传模块
- 文档解析模块
- 文档分片模块
- 向量化模块
- 检索模块
- 召回模块
- 重排模块
- Prompt处理模块
- LLM生成模块

### 第四阶段：接口开发
- RESTful API开发
- 命令行工具开发
- 接口测试

### 第五阶段：系统集成与测试
- 模块集成
- 系统测试
- 性能优化
- 安全性检查

### 第六阶段：部署与文档
- 部署脚本编写
- 用户文档编写
- 系统监控配置
- 项目交付

## 关键里程碑

| 里程碑 | 预计完成时间 | 交付物 |
|--------|-------------|--------|
| 需求分析完成 | 第1周 | 需求文档 |
| 架构设计完成 | 第2周 | 架构设计文档 |
| 基础环境搭建完成 | 第3周 | 可运行的开发环境 |
| 核心功能开发完成 | 第8周 | 功能模块代码 |
| 接口开发完成 | 第10周 | API文档 |
| 系统测试完成 | 第12周 | 测试报告 |
| 项目交付 | 第13周 | 完整系统 |

## 任务分解表（WBS）

### 1. 需求分析
- 1.1 功能需求收集
- 1.2 非功能需求定义
- 1.3 用户故事编写

### 2. 架构设计
- 2.1 系统架构图设计
- 2.2 数据库设计
- 2.3 API设计
- 2.4 技术组件选型

### 3. 环境搭建
- 3.1 项目目录结构创建
- 3.2 Docker配置
- 3.3 数据库初始化
- 3.4 依赖管理配置

### 4. 文档处理模块
- 4.1 文档上传功能
- 4.2 文档解析功能
- 4.3 文档分片功能
### 4.4 向量化功能

- 实现可扩展的Embedding架构，支持多种Embedding提供商
  - 定义EmbeddingBase抽象基类，规定统一的接口规范
  - 实现SiliconFlowEmbedding类，使用硅基流动的Embedding API
  - 实现LocalAPIEmbedding类，支持通过本地API进行向量化
  - 支持通过参数指定Embedding提供商
  - 实现WeaviateVector类，基于llamaindex集成Weaviate向量数据库操作
  - 在RAGPipeline中集成向量化处理流程，自动将文档分块存储到向量数据库

### 5. 检索与召回模块
- 5.1 检索算法实现
  - 定义RetrievalBase抽象基类，规定统一的接口规范
  - 实现VectorRetriever类，基于Weaviate向量数据库实现向量检索
- 5.2 召回策略实现
- 5.1 检索算法实现
- 5.2 召回策略实现

### 6. 重排与Prompt模块
- 6.1 重排算法实现
- 6.2 Prompt模板设计
  - 实现PromptEngine类，支持Prompt模板管理和动态生成

### 7. LLM生成模块
- 7.1 LLM集成
  - 实现LocalAPILLM类，支持通过本地API进行文本生成
- 7.2 生成结果优化

### 8. 接口开发
- 8.1 RESTful API实现
- 8.2 命令行工具实现
- 8.3 接口文档编写

### 9. 测试
- 9.1 单元测试
  - 完成RAGPipeline类的单元测试
  - 完成各组件模块的单元测试
- 9.2 集成测试
- 9.3 性能测试

### 10. 部署
- 10.1 部署脚本编写
- 10.2 监控配置
- 10.3 用户文档

## 预计时长
总预计开发周期：13周（约3个月）

- 需求分析与架构设计：2周
- 基础环境搭建：1周
- 核心功能开发：5周
- 接口开发：2周
- 系统集成与测试：2周
- 部署与文档：1周

## 主要风险项

### 1. 技术风险
- 向量化效果不达预期
- 检索召回准确率不足
- LLM生成质量不稳定

### 2. 进度风险
- 核心算法实现复杂度超出预期
- 第三方组件集成问题
- 性能优化耗时较长

### 3. 资源风险
- 开发人员技能不匹配
- 硬件资源不足
- 第三方服务限制

### 4. 质量风险
- 系统稳定性问题
- 数据安全与隐私保护
- 并发处理能力不足
